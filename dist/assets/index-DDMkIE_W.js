import{x as q,a as H,y as B,r as m,o as I,c as g,b as Y,d as J,e as u,f as D,g as e,i,t as r,p,k as n,l as y,v as K,m as M,n as O,h as _,F as Q,q as W,z as X}from"./index-EqsJQukp.js";import{u as Z}from"./offers-CMuGKdpP.js";import{u as ee,S as N,s as te,_ as se}from"./navItems-BcGEYHfz.js";import{_ as oe}from"./ApplicationModal-kxLG78Mn.js";import{B as R}from"./briefcase-DCx-JBHg.js";import{T as le,S as re}from"./target-Cbvg5X6-.js";import{D as ae}from"./dollar-sign-C1C06PUc.js";import{T as ne}from"./trending-up-D3ODJZ_R.js";import{C as ie}from"./calendar-QZZnOdG5.js";import{E as ce}from"./eye-4dZziO83.js";import"./authHeader-DkpUnqMe.js";import"./applications-CVJmNFuW.js";import"./x-c6Y77DFi.js";import"./upload-C3RSQhGF.js";import"./circle-check-big-BfLp0Q0m.js";const de={class:"min-h-screen bg-gray-50"},ue={class:"bg-white border-b border-gray-200"},pe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},me={class:"flex items-center justify-between h-16"},ge={class:"flex items-center space-x-4"},xe={class:"text-sm text-gray-600"},fe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},he={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},ve={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4"},be={class:"flex items-center justify-between"},ye={class:"text-3xl font-bold text-gray-900 mt-2"},_e={class:"p-3 bg-blue-100 rounded-xl"},we={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4"},Se={class:"flex items-center justify-between"},Ae={class:"text-3xl font-bold text-gray-900 mt-2"},Ce={class:"p-3 bg-green-100 rounded-xl"},Pe={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4"},ke={class:"flex items-center justify-between"},Be={class:"text-3xl font-bold text-gray-900 mt-2"},De={class:"p-3 bg-purple-100 rounded-xl"},Me={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4"},Oe={class:"flex items-center justify-between"},Ne={class:"text-3xl font-bold text-gray-900 mt-2"},Re={class:"p-3 bg-coral-100 rounded-xl"},Le={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8"},Te={class:"flex flex-col space-y-4"},je={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0"},Fe={class:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 flex-1"},Ve={class:"relative"},$e={class:"flex items-center space-x-3"},Ue={key:0,class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-12 text-center"},Ee={class:"text-gray-600 mb-6"},Ge={key:1,class:"grid gap-6"},ze={class:"p-6"},qe={class:"flex items-start justify-between mb-4"},He={class:"flex-1"},Ie={class:"flex items-center space-x-3 mb-2"},Ye={class:"text-xl font-semibold text-gray-900"},Je={class:"flex items-center space-x-2 mb-2"},Ke=["src","alt"],Qe={class:"text-gray-600"},We={class:"text-gray-700 line-clamp-2"},Xe={class:"text-right ml-6"},Ze={class:"text-2xl font-bold text-coral-600"},et={class:"mb-4"},tt={class:"flex items-center justify-between text-sm text-gray-600 mb-2"},st={class:"w-full bg-gray-200 rounded-full h-2"},ot={class:"flex flex-wrap gap-2 mb-4"},lt={key:0,class:"bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full"},rt={key:1,class:"bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded-full"},at={class:"flex items-center justify-between pt-4 border-t border-gray-100"},nt={class:"flex items-center space-x-2 text-sm text-gray-500"},it={class:"flex items-center space-x-2"},ct=["onClick"],Pt={__name:"index",setup(dt){q();const f=Z(),L=ee(),T=H(),a=B({search:"",amountRange:"",course:""}),d=m(!1),c=B({show:!1,mode:"create",offer:null,application:null}),x=m([]),w=m(null);let v=m(0),S=m(0),A=m(0);I(async()=>{f.initializeOffers();try{const[o,t]=await Promise.allSettled([f.fetchOffers(),L.getProfile()]);o.status==="fulfilled"?(x.value=o.value.data,v=o.value.data.reduce((l,s)=>l+s.offerBudget,0),S=o.value.data.reduce((l,s)=>l+s.offerAmountPerStudent,0),A=S/o.value.data.length,console.log("Total Budget:",v),console.log("Offers data:",x.value)):console.log("Offers failed:",o.reason),t.status==="fulfilled"?(w.value=t.value,console.log("Student details:",w.value)):console.log("Student details failed:",t.reason)}catch(o){console.log("error from the offer page",o)}});const j=g(()=>({school:"University of Lagos",course:"Computer Science",level:"400 Level",gpa:4.2,gender:"male",state:"Lagos",age:22})),h=g(()=>f.getOffers),C=g(()=>f.getMatchingOffers(j.value)),F=g(()=>h.value.reduce((o,t)=>o+t.amount,0));g(()=>h.value.length===0?0:Math.round(F.value/h.value.length));const V=g(()=>{let o=d.value?C.value:h.value;if(a.search){const t=a.search.toLowerCase();o=o.filter(l=>{var s,b,k;return((s=l.title)==null?void 0:s.toLowerCase().includes(t))||((b=l.sponsorName)==null?void 0:b.toLowerCase().includes(t))||((k=l.description)==null?void 0:k.toLowerCase().includes(t))})}return a.amountRange&&(o=o.filter(t=>{const l=t.amount;switch(a.amountRange){case"0-100000":return l<=1e5;case"100000-200000":return l>1e5&&l<=2e5;case"200000-300000":return l>2e5&&l<=3e5;case"300000+":return l>3e5;default:return!0}})),a.course&&(o=o.filter(t=>{var l,s;return((l=t.criteria.courses)==null?void 0:l.includes(a.course))||((s=t.criteria.courses)==null?void 0:s.length)===0})),o.sort((t,l)=>new Date(l.createdAt)-new Date(t.createdAt))}),$=o=>({merit_based:"bg-blue-100 text-blue-700",holistic:"bg-purple-100 text-purple-700",research_based:"bg-green-100 text-green-700",portfolio_based:"bg-orange-100 text-orange-700"})[o]||"bg-gray-100 text-gray-700",U=o=>({merit_based:"Merit Based",holistic:"Holistic Review",research_based:"Research Based",portfolio_based:"Portfolio Based"})[o]||o,P=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",E=()=>{a.search="",a.amountRange="",a.course="",d.value=!1},G=o=>{c.offer=o,c.mode="create",c.application=null,c.show=!0},z=()=>{c.show=!1,T.addNotification({type:"success",title:"Application submitted",message:"Your application has been submitted successfully!"})};return(o,t)=>{const l=Y("router-link");return u(),J(se,{"page-title":"Offers","page-subtitle":"manage your funding offers","navigation-items":n(te)},{default:D(()=>[e("div",de,[e("div",ue,[e("div",pe,[e("div",me,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"}," Browse Opportunities "),e("p",{class:"text-sm text-gray-500"}," Discover funding opportunities that match your profile ")],-1)),e("div",ge,[e("span",xe,r(x.value.length)+" opportunities available",1)])])])]),e("div",fe,[e("div",he,[e("div",ve,[e("div",be,[e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Offers",-1)),e("p",ye,r(x.value.length??0),1)]),e("div",_e,[i(n(R),{class:"w-6 h-6 text-blue-600"})])])]),e("div",we,[e("div",Se,[e("div",null,[t[8]||(t[8]=e("p",{class:"text-sm font-medium text-gray-600"},"Perfect Matches",-1)),e("p",Ae,r(C.value.length),1)]),e("div",Ce,[i(n(le),{class:"w-6 h-6 text-green-600"})])])]),e("div",Pe,[e("div",ke,[e("div",null,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Funding",-1)),e("p",Be," ₦"+r(n(v).toLocaleString()),1)]),e("div",De,[i(n(ae),{class:"w-6 h-6 text-purple-600"})])])]),e("div",Me,[e("div",Oe,[e("div",null,[t[10]||(t[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Avg. Amount",-1)),e("p",Ne," ₦"+r(Math.floor(n(A)).toLocaleString()),1)]),e("div",Re,[i(n(ne),{class:"w-6 h-6 text-coral-600"})])])])]),e("div",Le,[e("div",Te,[e("div",je,[e("div",Fe,[e("div",Ve,[i(n(N),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.search=s),type:"text",placeholder:"Search opportunities...",class:"pl-10 pr-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-coral-500 focus:border-coral-500 w-full sm:w-64"},null,512),[[K,a.search]])]),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.amountRange=s),class:"px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-coral-500 focus:border-coral-500"},t[11]||(t[11]=[e("option",{value:""},"Any Amount",-1),e("option",{value:"0-100000"},"₦0 - ₦100,000",-1),e("option",{value:"100000-200000"},"₦100,000 - ₦200,000",-1),e("option",{value:"200000-300000"},"₦200,000 - ₦300,000",-1),e("option",{value:"300000+"},"₦300,000+",-1)]),512),[[M,a.amountRange]]),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.course=s),class:"px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-coral-500 focus:border-coral-500"},t[12]||(t[12]=[e("option",{value:""},"All Courses",-1),e("option",{value:"Computer Science"},"Computer Science",-1),e("option",{value:"Engineering"},"Engineering",-1),e("option",{value:"Medicine"},"Medicine",-1),e("option",{value:"Business Administration"},"Business",-1),e("option",{value:"Agriculture"},"Agriculture",-1),e("option",{value:"Fine Arts"},"Arts",-1)]),512),[[M,a.course]])]),e("div",$e,[e("button",{onClick:t[3]||(t[3]=s=>d.value=!d.value),class:O(["px-4 py-2 rounded-xl transition-colors",d.value?"bg-coral-500 text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50"])},r(d.value?"Show All":"Perfect Matches Only"),3),e("button",{onClick:E,class:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors"}," Clear Filters ")])])])]),V.value.length===0?(u(),p("div",Ue,[i(n(R),{class:"h-16 w-16 text-gray-300 mx-auto mb-4"}),t[14]||(t[14]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"}," No opportunities found ",-1)),e("p",Ee,r(d.value?"No opportunities match your profile. Try browsing all opportunities.":"No opportunities match your current filters."),1),d.value?(u(),p("button",{key:0,onClick:t[4]||(t[4]=s=>d.value=!1),class:"bg-coral-500 text-white px-6 py-3 rounded-lg hover:bg-coral-600 transition-colors duration-200 inline-flex items-center space-x-2"},[i(n(N),{class:"h-5 w-5"}),t[13]||(t[13]=e("span",null,"Browse All Opportunities",-1))])):_("",!0)])):(u(),p("div",Ge,[(u(!0),p(Q,null,W(x.value,s=>(u(),p("div",{key:s._id,class:"bg-white rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200"},[e("div",ze,[e("div",qe,[e("div",He,[e("div",Ie,[e("h3",Ye,r(s.offerTitle),1),e("span",{class:O([$(s.offerSelectionProcess),"px-2 py-1 rounded-full text-xs font-medium"])},r(U(s.offerSelectionProcess)),3)]),e("div",Je,[e("img",{src:s==null?void 0:s.sponsorAvatar,alt:s==null?void 0:s.sponsorName,class:"w-6 h-6 rounded-full border border-gray-200"},null,8,Ke),e("span",Qe,r((s==null?void 0:s.sponsorName)??"no name yet"),1)]),e("p",We,r(s.offerDescription),1)]),e("div",Xe,[e("p",Ze," ₦"+r(s.offerAmountPerStudent.toLocaleString()),1),t[15]||(t[15]=e("p",{class:"text-sm text-gray-500"},"per recipient",-1))])]),e("div",et,[e("div",tt,[e("span",null," Recipients: "+r(s.currentRecipients??1)+"/"+r(Math.floor(s.offerBudget/s.offerAmountPerStudent)),1),e("span",null,"Deadline: "+r(P(s.offerDeadline)),1)]),e("div",st,[e("div",{class:"bg-coral-500 h-2 rounded-full transition-all duration-300",style:X({width:(s.currentRecipients??1)/Math.floor(s.offerBudget/s.offerAmountPerStudent)*100+"%"})},null,4)])]),e("div",ot,[s.offerTargetGPA?(u(),p("span",lt," Min GPA: "+r(s.offerTargetGPA),1)):_("",!0),s.offerGenderPreference!=="Any"?(u(),p("span",rt,r(s.offerGenderPreference)+" only ",1)):_("",!0)]),e("div",at,[e("div",nt,[i(n(ie),{class:"h-4 w-4"}),e("span",null,"Posted "+r(P(s.createdAt)),1)]),e("div",it,[i(l,{to:`/student/offers/${s._id}`,class:"px-4 py-2 text-coral-600 hover:bg-coral-50 rounded-lg transition-colors duration-200 flex items-center space-x-1"},{default:D(()=>[i(n(ce),{class:"h-4 w-4"}),t[16]||(t[16]=e("span",null,"View Details",-1))]),_:2,__:[16]},1032,["to"]),e("button",{onClick:b=>G(s),class:"px-4 py-2 bg-coral-500 text-white rounded-lg hover:bg-coral-600 transition-colors duration-200 flex items-center space-x-1"},[i(n(re),{class:"h-4 w-4"}),t[17]||(t[17]=e("span",null,"Apply Now",-1))],8,ct)])])])]))),128))]))])]),i(oe,{"is-open":c.show,mode:c.mode,item:c.offer,application:c.application,onClose:t[5]||(t[5]=s=>c.show=!1),onSuccess:z},null,8,["is-open","mode","item","application"])]),_:1},8,["navigation-items"])}}};export{Pt as default};
