import{u as j,a as R,r as p,y as Y,o as E,d as M,e as m,f as q,g as t,k as f,n as h,t as u,A as z,p as x,h as U,l as r,v as n,m as P}from"./index-EqsJQukp.js";import{u as D,s as B,_ as O}from"./navItems-BcGEYHfz.js";import"./authHeader-DkpUnqMe.js";const T={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},G={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},I={class:"lg:col-span-1"},K={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6"},$={class:"text-center"},H={class:"relative inline-block"},Q=["src","alt"],J=["disabled"],W={class:"text-xl font-bold text-gray-900 mt-4"},X={class:"text-gray-600 capitalize"},Z={class:"mt-4 flex justify-center"},ee={class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mt-6"},te={class:"space-y-4"},oe={class:"flex justify-between"},ae={class:"font-semibold text-gray-900"},se={class:"flex justify-between"},le={class:"font-semibold text-gray-900"},ie={class:"flex justify-between"},re={class:"font-semibold text-gray-900"},ne={class:"lg:col-span-2"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},ue=["disabled"],pe=["disabled"],me={class:"mb-6"},fe=["disabled"],ce={class:"mb-6"},be=["disabled"],ve={class:"mb-6"},ge=["disabled"],ye={key:0,class:"space-y-6 mb-6"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ne=["disabled"],he=["disabled"],we={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},_e=["disabled"],Se=["disabled"],ke=["disabled"],Ue={key:1,class:"space-y-6 mb-6"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ve=["disabled"],Ae=["disabled"],Fe={class:"flex justify-end space-x-4"},Le=["disabled"],Ce=["disabled"],Me={__name:"profile",setup(je){const c=j(),N=D(),b=R(),v=p({}),d=p({}),l=p(!1),V=p({}),g=p(!1),w=p(null),o=Y({firstName:"",lastName:"",email:"",phone:"",bio:"",school:"",course:"",level:"",gpa:"",graduationYear:"",state:"",city:"",academicAchievements:"",goals:"",avatar:null});E(async()=>{try{const a=await N.getProfile();a?(d.value=a,d.value.name=a.firstName+" "+a.lastName||"",_(d.value)):console.log("No details found");const e=await N.getStudentStats();v.value=e.stats||{}}catch(a){console.log("Failed to get student stats"),console.log("error",a)}});const _=a=>{a&&(V.value={...a},o.firstName=a.firstName,o.lastName=a.lastName,o.email=a.email||"",o.phone=a.phoneNumber||"",o.bio=a.bio||"",o.school=a.instituteName||"",o.course=a.courseOfStudy||"",o.level=a.level||"",o.gpa=a.gpa?parseFloat(a.gpa):"",o.graduationYear=a.expectedGraduation?parseFloat(a.expectedGraduation):"unknown",o.organization=a.organization||"",o.position=a.position||"",o.sponsorType=a.sponsorType||"individual",o.state=a.location||"",o.city=a.city||"",o.avatarUrl=a.profilePic||"")},A=()=>{_(d.value)},F=()=>{var a;(a=w.value)==null||a.click()},L=a=>{const e=a.target.files[0];if(e){o.avatar=e;const i=new FileReader;i.onload=y=>{o.avatarUrl=y.target.result},i.readAsDataURL(e),b.addNotification({type:"info",title:"Profile picture updated",message:"Your have add profile picture, click the update profile to save"})}},C=async()=>{g.value=!0;try{const a=o.avatar instanceof File,e=new FormData;e.append("firstName",o.firstName||""),e.append("lastName",o.lastName||""),e.append("email",o.email||""),e.append("phoneNumber",o.phone||""),e.append("bio",o.bio||""),e.append("instituteName",o.school||""),e.append("courseOfStudy",o.course||""),e.append("level",o.level||""),e.append("gpa",o.gpa?o.gpa.toString():""),e.append("expectedGraduation",o.graduationYear?o.graduationYear.toString():""),e.append("location",o.state||""),e.append("city",o.city||""),e.append("name",`${o.firstName} ${o.lastName}`),a&&e.append("profilePic",o.avatar);const i=await N.editStudentProfile(e);i&&i.success?(b.addNotification({type:"success",title:"Profile updated",message:"Your profile has been updated successfully.",duration:1900}),setTimeout(()=>{window.location.reload()},2e3)):(b.addNotification({type:"error",title:"Profile unable to update",message:(i==null?void 0:i.message)||"Failed to update profile."}),console.error("Profile update failed:",i))}catch(a){console.error("Profile update error:",a),b.addNotification({type:"error",title:"Update failed",message:"Failed to update profile. Please try again."})}finally{g.value=!1,l.value=!1}};return(a,e)=>(m(),M(O,{"page-title":"Settings","page-subtitle":"Manage your account settings and preferences","navigation-items":f(B)},{default:q(()=>{var i,y,S,k;return[t("div",T,[e[35]||(e[35]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"Profile"),t("p",{class:"text-gray-600 mt-2"}," Manage your personal information and preferences ")],-1)),t("div",G,[t("div",I,[t("div",K,[t("div",$,[t("div",H,[t("img",{src:o.avatarUrl||((i=f(c).user)==null?void 0:i.avatar)||"/avatar.png",alt:(y=f(c).user)==null?void 0:y.name,class:"w-32 h-32 rounded-full object-cover border-4 border-gray-200 mx-auto"},null,8,Q),t("button",{onClick:F,disabled:!l.value,class:h(["absolute bottom-0 right-0 p-2 rounded-full transition-colors duration-200",l.value?"bg-coral-500 hover:bg-coral-600":"bg-gray-400 cursor-not-allowed"])},e[13]||(e[13]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]),10,J),t("input",{ref_key:"fileInput",ref:w,type:"file",accept:"image/*",onChange:L,class:"hidden"},null,544)]),t("h2",W,u(d.value.name),1),t("p",X,u((S=f(c).user)==null?void 0:S.role),1),t("div",Z,[t("span",{class:h(["px-3 py-1 rounded-full text-sm font-medium",d.value.isEmailVerified?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"])},u(d.value.isEmailVerified?"Email Verified":"Pending Email Verification"),3)])])]),t("div",ee,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"}," Quick Stats ",-1)),t("div",te,[t("div",oe,[e[14]||(e[14]=t("span",{class:"text-gray-600"},"Active Appeals",-1)),t("span",ae,u(v.value.totalRequests??0),1)]),t("div",se,[e[15]||(e[15]=t("span",{class:"text-gray-600"},"Total Raised",-1)),t("span",le,"â‚¦"+u((v.value.totalAmountReceived??0).toLocaleString()),1)]),t("div",ie,[e[16]||(e[16]=t("span",{class:"text-gray-600"},"Available Offers",-1)),t("span",re,u(v.value.availableOffers??0),1)])])])]),t("div",ne,[t("form",{onSubmit:z(C,["prevent"]),class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6"},[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-6"}," Personal Information ",-1)),t("div",de,[t("div",null,[e[18]||(e[18]=t("label",{for:"firstName",class:"form-label"},"First Name",-1)),r(t("input",{id:"firstName","onUpdate:modelValue":e[0]||(e[0]=s=>o.firstName=s),type:"text",required:"",class:"form-input",disabled:!l.value},null,8,ue),[[n,o.firstName]])]),t("div",null,[e[19]||(e[19]=t("label",{for:"lastName",class:"form-label"},"Last Name",-1)),r(t("input",{id:"lastName","onUpdate:modelValue":e[1]||(e[1]=s=>o.lastName=s),type:"text",required:"",class:"form-input",disabled:!l.value},null,8,pe),[[n,o.lastName]])])]),t("div",me,[e[20]||(e[20]=t("label",{for:"email",class:"form-label"},"Email Address",-1)),r(t("input",{id:"email","onUpdate:modelValue":e[2]||(e[2]=s=>o.email=s),type:"email",required:"",class:"form-input",disabled:!l.value},null,8,fe),[[n,o.email]])]),t("div",ce,[e[21]||(e[21]=t("label",{for:"phone",class:"form-label"},"Phone Number",-1)),r(t("input",{id:"phone","onUpdate:modelValue":e[3]||(e[3]=s=>o.phone=s),type:"tel",class:"form-input",disabled:!l.value,placeholder:"+234 xxx xxx xxxx"},null,8,be),[[n,o.phone]])]),t("div",ve,[e[22]||(e[22]=t("label",{for:"bio",class:"form-label"},"Bio",-1)),r(t("textarea",{id:"bio","onUpdate:modelValue":e[4]||(e[4]=s=>o.bio=s),rows:"4",class:"form-input",disabled:!l.value,placeholder:"Tell us about yourself..."},null,8,ge),[[n,o.bio]])]),((k=f(c).user)==null?void 0:k.role)==="student"?(m(),x("div",ye,[e[29]||(e[29]=t("h4",{class:"text-md font-semibold text-gray-900 border-t pt-6"}," Academic Information ",-1)),t("div",xe,[t("div",null,[e[23]||(e[23]=t("label",{for:"school",class:"form-label"},"School/University",-1)),r(t("input",{id:"school","onUpdate:modelValue":e[5]||(e[5]=s=>o.school=s),type:"text",required:"",class:"form-input",disabled:!l.value},null,8,Ne),[[n,o.school]])]),t("div",null,[e[24]||(e[24]=t("label",{for:"course",class:"form-label"},"Course of Study",-1)),r(t("input",{id:"course","onUpdate:modelValue":e[6]||(e[6]=s=>o.course=s),type:"text",required:"",class:"form-input",disabled:!l.value},null,8,he),[[n,o.course]])])]),t("div",we,[t("div",null,[e[26]||(e[26]=t("label",{for:"level",class:"form-label"},"Academic Level",-1)),r(t("select",{id:"level","onUpdate:modelValue":e[7]||(e[7]=s=>o.level=s),required:"",class:"form-input",disabled:!l.value},e[25]||(e[25]=[t("option",{value:""},"Select level",-1),t("option",{value:"100"},"100 Level",-1),t("option",{value:"200"},"200 Level",-1),t("option",{value:"300"},"300 Level",-1),t("option",{value:"400"},"400 Level",-1),t("option",{value:"500"},"500 Level",-1),t("option",{value:"Postgraduate"},"Postgraduate",-1)]),8,_e),[[P,o.level]])]),t("div",null,[e[27]||(e[27]=t("label",{for:"gpa",class:"form-label"},"Current GPA",-1)),r(t("input",{id:"gpa","onUpdate:modelValue":e[8]||(e[8]=s=>o.gpa=s),type:"number",step:"0.01",min:"0",max:"5",class:"form-input",disabled:!l.value},null,8,Se),[[n,o.gpa,void 0,{number:!0}]])]),t("div",null,[e[28]||(e[28]=t("label",{for:"graduationYear",class:"form-label"},"Expected Graduation",-1)),r(t("input",{id:"graduationYear","onUpdate:modelValue":e[9]||(e[9]=s=>o.graduationYear=s),type:"number",min:"2024",max:"2030",class:"form-input",disabled:!l.value},null,8,ke),[[n,o.graduationYear,void 0,{number:!0}]])])])])):U("",!0),o.state?(m(),x("div",Ue,[e[33]||(e[33]=t("h4",{class:"text-md font-semibold text-gray-900 border-t pt-6"}," Location ",-1)),t("div",Pe,[t("div",null,[e[31]||(e[31]=t("label",{for:"state",class:"form-label"},"State",-1)),r(t("select",{id:"state","onUpdate:modelValue":e[10]||(e[10]=s=>o.state=s),class:"form-input",disabled:!l.value},e[30]||(e[30]=[t("option",{value:""},"Select state",-1),t("option",{value:"Lagos"},"Lagos",-1),t("option",{value:"Abuja"},"Abuja",-1),t("option",{value:"Kano"},"Kano",-1),t("option",{value:"Rivers"},"Rivers",-1),t("option",{value:"Oyo"},"Oyo",-1),t("option",{value:"Kaduna"},"Kaduna",-1)]),8,Ve),[[P,o.state]])]),t("div",null,[e[32]||(e[32]=t("label",{for:"city",class:"form-label"},"City",-1)),r(t("input",{id:"city","onUpdate:modelValue":e[11]||(e[11]=s=>o.city=s),type:"text",class:"form-input",disabled:!l.value},null,8,Ae),[[n,o.city]])])])])):U("",!0),t("div",Fe,[t("button",{type:"button",onClick:A,disabled:!l.value,class:h(["px-6 py-2 border border-gray-300 rounded-xl text-gray-700 transition-colors duration-200",l.value?"hover:bg-gray-200 cursor-pointer":"cursor-not-allowed bg-gray-100"])}," Reset ",10,Le),l.value?(m(),x("button",{key:1,type:"submit",disabled:g.value,class:"btn-primary"},u(g.value?"Updating...":"Update Profile"),9,Ce)):(m(),x("button",{key:0,type:"submit",class:"btn-primary bg-red-200",onClick:e[12]||(e[12]=s=>l.value=!0)}," Edit Profile "))])],32)])])])]}),_:1},8,["navigation-items"]))}};export{Me as default};
