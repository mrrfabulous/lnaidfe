import{V as i,W as A,N as S,r as w,X as v,c as d,a0 as h}from"./index-EqsJQukp.js";import{g}from"./authHeader-DkpUnqMe.js";const m=async()=>{var a,r;try{return(await i.get(A.STUDENTS.APPEAL.GET_ALL,{headers:g()})).data}catch(n){console.error("error:",n);const o=((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.message)||n.message||"failed";throw new Error(o)}},E=async a=>{var r,n;try{return(await i.post(`${A.STUDENTS.APPEAL.CREATE}`,a,{headers:g(!0)})).data}catch(o){console.error("error:",o);const p=((n=(r=o.response)==null?void 0:r.data)==null?void 0:n.message)||o.message||"failed";throw new Error(p)}},N=S("appeals",()=>{const a=w([]),r=v();r!=null&&r.id;const n=d(()=>e=>a.value.find(t=>t.id===parseInt(e))),o=d(()=>e=>a.value.filter(t=>t.userId===e)||[]),p=()=>{h(a.value)},f=async()=>{const e=await m();console.log(e),e.success?(a.value=e.data,p()):console.log("Failed to get appeals")},c=async e=>{console.log("Creating appeal with data:",e);const t=await E(e);if(console.log(t),t.success){const s=t.data;a.value.push(s)}return p(),t.data||null},u=(e,t)=>{const s=a.value.findIndex(l=>l.id===e);return s!==-1?(a.value[s]={...a.value[s],...t,updatedAt:new Date().toISOString()},p(),a.value[s]):null};return{appeals:a,getAppeals:f,getAppealById:n,getUserAppeals:o,createAppeal:c,addAppeal:e=>c(e),updateAppeal:u,updateAppealStatus:(e,t)=>u(e,{status:t}),deleteAppeal:e=>{const t=a.value.findIndex(s=>s.id===e);return t!==-1?(a.value.splice(t,1),p(),!0):!1},donateToAppeal:(e,t)=>{const s=a.value.find(l=>l.id===e);return s?(s.donations.push({id:Date.now(),...t,date:new Date().toISOString()}),s.raisedAmount+=t.amount,s.updatedAt=new Date().toISOString(),p(),!0):!1}}});export{N as u};
