import{V as u,W as d,N as O,r as p,c as m}from"./index-EqsJQukp.js";import{g}from"./authHeader-DkpUnqMe.js";const E=async s=>{try{console.log("Creating scholarship with data:",s);const o=await u.post(d.SPONSORS.SCHOLARSHIPS.CREATE,s,{headers:g()});return console.log("Scholarship created successfully:",o.data),o.data}catch(o){if(console.error("Create scholarship error:",o),o.response&&o.response.data)return console.log("Server error response:",o.response.data),{success:!1,message:o.response.data.message||"Scholarship creation failed",...o.response.data};const l=o.message||"Network error occurred";throw new Error(l)}},v=async()=>{try{const s=await u.get(d.SPONSORS.SCHOLARSHIPS.GET_ALL,{headers:g()});return console.log("Scholarships fetched successfully:",s.data),s.data}catch(s){if(console.error("Get scholarships error:",s),s.response&&s.response.data)return{success:!1,message:s.response.data.message||"Failed to fetch scholarships",...s.response.data};const o=s.message||"Network error occurred";throw new Error(o)}},C=async s=>{try{return(await u.get(`${d.SPONSORS.SCHOLARSHIPS.GET_ONE}/${s}`,{headers:g()})).data}catch(o){if(console.error("Get scholarship by ID error:",o),o.response&&o.response.data)return{success:!1,message:o.response.data.message||"Failed to fetch scholarship",...o.response.data};const l=o.message||"Network error occurred";throw new Error(l)}},x=O("scholarships",()=>{const s=p([]),o=p(!1),l=p(null),w=async()=>{try{const e=await v();return e}catch(e){throw new Error(e.message)}},y=async e=>{console.log("this is the ID I passed:",e);try{const a=await C(e);return a}catch(a){throw new Error(a.message)}},I=m(()=>e=>s.value.filter(a=>a.sponsorId===e)),A=m(()=>e=>s.value.filter(a=>{var t,i,f;if(a.status!=="active")return!1;const r=a.criteria;return(!((t=r.schools)!=null&&t.length)||r.schools.includes(e.school))&&(!((i=r.courses)!=null&&i.length)||r.courses.includes(e.course))&&(!((f=r.levels)!=null&&f.length)||r.levels.includes(e.level))&&(!r.minGPA||e.gpa>=r.minGPA)&&(!r.gender||r.gender==="any"||e.gender===r.gender)&&(!r.financialNeed||e.financialNeed===!0)})),S=async()=>{o.value=!0,l.value=null;try{console.log("Fetching scholarships from API...");const e=await v();e.success!==!1?(s.value=e.data||e||[],console.log("Scholarships loaded from API:",s.value.length),localStorage.setItem("edufund_scholarships",JSON.stringify(s.value))):(console.warn("API returned error:",e.message),l.value=e.message,await h())}catch(e){console.error("Failed to fetch scholarships from API:",e),e.value=e.message,await h()}finally{o.value=!1}},h=async()=>{const e=localStorage.getItem("edufund_scholarships");e?(s.value=JSON.parse(e),console.log("Scholarships loaded from cache:",s.value.length)):(s.value=[],console.log("No scholarships available - starting with empty array"))},N=async()=>{await S()},n=()=>{localStorage.setItem("edufund_scholarships",JSON.stringify(s.value))};return{scholarships:s,loading:o,error:l,getScholarships:w,getScholarshipById:y,getSponsorScholarships:I,getMatchingScholarships:A,initializeScholarships:S,loadFromCache:h,refreshScholarships:N,createScholarship:async e=>{try{console.log("Creating scholarship with thtis data:",e);const a=await E(e);if(a.success!==!1){const r=a.data||a;return s.value.push(r),n(),{success:!0,data:r}}else return{success:!1,message:a.message};console.log("Scholarship conditions was successfully:",a)}catch(a){return console.error("Failed to create scholarship:",a),{success:!1,message:a.message}}},updateScholarship:(e,a)=>{const r=s.value.findIndex(c=>c.id===e);return r!==-1?(s.value[r]={...s.value[r],...a},n(),s.value[r]):null},applyToScholarship:(e,a)=>{const r=s.value.find(c=>c.id===e);if(r){r.applications||(r.applications=[]);const c={id:Date.now(),...a,status:"pending",submittedAt:new Date().toISOString()};return r.applications.push(c),n(),c}return null},updateApplicationStep:(e,a,r)=>{const c=s.value.find(t=>t.id===e);if(c&&c.applications){const t=c.applications.find(i=>i.id===a);if(t)return t.currentStep=r.step,t.stepData={...t.stepData,...r.data},n(),t}return null},updateApplicationStatus:(e,a,r)=>{const c=s.value.find(t=>t.id===e);if(c&&c.applications){const t=c.applications.find(i=>i.id===a);if(t)return t.status=r,t.updatedAt=new Date().toISOString(),n(),t}return null},deleteScholarship:e=>{const a=s.value.findIndex(r=>r.id===e);if(a!==-1){const r=s.value.splice(a,1)[0];return n(),r}return null}}});export{x as u};
